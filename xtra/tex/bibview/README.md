# bibview

This is a small GUI application, whose intent is to quickly render a bibliography entry using different parameters - for now using `bibtex` only. It is currently implemented as a `pygtk` (Python2.7 / Gtk2) application.

[![bibview_pygtk screenshot - pixel tab](http://sdaaubckp.sf.net/xtra/bibview/bibview_pygtk_01.png)](http://sdaaubckp.sf.net/xtra/bibview/bibview_pygtk_01.png)

First, note that the application is written in respect to a Texlive installation base directory; in the script, you should change the `TLDIR = "/path/to/texlive/2011"` to the actual path to your Texlive installation. Alternatively, you can call the application, specifying `TLDIR` as a shell environment variable:

    $ TLDIR=/path/to/your/texlive/201x python bibview_pygtk.py

Do note, however, that the application makes system calls to `bibtex`, `pdflatex` and `htlatex` _without_ using this variable; thus, you should call this application from a shell, where these commands are callable as such. The application also makes use of ImageMagick's `convert`, to generate the rendering shown on the "pixel" tab (as on the image).  

## Overview

For me, it is always difficult to remember what sort of bibliography fields are going to be rendered in what way; especially when I haven't used `bibtex` in a while. This is also difficult because different settings cause different outputs. This application addresses that by offering a text field, where a `.bib` entry can be pasted. Then, depending on the chosen settings, output will be rendered in the chosen tab below. 

Here is an overview of dropdown menu contents:

[![overview of dropdowns - raw tab](http://sdaaubckp.sf.net/xtra/bibview/bibview_pygtk_02.png)](http://sdaaubckp.sf.net/xtra/bibview/bibview_pygtk_02.png)

* The first dropdown indicates that, in principle, you could choose from multiple engines; only `bibtex` is implemented for now (the other two are just mock up).
* The second dropdown shows `bibtex` bibliography styles (`.bst`); 
* The third dropdown shows types of `bibtex` bibliography entries (`@article {...`, `@book {...`, etc)
* The fourth dropdown shows Latex document classes (`{article}`, `{minimal}`, etc)

The list in second and fourth dropdown is actually generated by the application scanning the corresponding Texlive directories for files. The fourth dropdown only has effect on Latex-generated output (therefore, I would have rather had it on the same rows as the tabs, aligned right; unfortunately, I couldn't find a straightforward way to do that in `pygtk`).

Since the second and third dropdown have effect on the bibtex output itself, they also have two "arrow" selectors at their ends, for quick "stepping" through the items of that dropdown. Stepping through the third dropdown - the bibliography entry type - also changes the corresponding text in the textfield entry, otherwise highlighted in red. These two dropdowns also show some data on mouseover:

[![mouseovers on second and third dropdown - html tab](http://sdaaubckp.sf.net/xtra/bibview/bibview_pygtk_03.png)](http://sdaaubckp.sf.net/xtra/bibview/bibview_pygtk_03.png)

Mouseover on second dropdown shows all of the fields a particular `.bst` file declares (and are parsed directly from those files). Mouseover on third dropdown attempts to show which of those are used in the currently selected bibliography entry type; note, however, that the algorithm simply scans for `output` and `output.check` bibtex commands, which cannot determine the full entirety of used fields: especially because some may be conditionally processed (in context of existence of a different field), and that is done through function calls.

In any case, for whatever present `bibtex` entry in the text editor, the entry type will be highlighted in red, and the citation key in yellow. Ultimately, the idea was that also the fields of the entry would have been highlighted, depending on whether they are processed for that entry type; because of the above complexity, that is not implemented for the time being.  When the application starts, the text field is set to a default content, which also includes an UTF-8 character as a test.

## Output

The output is rendered into the tabs on the lower half; the raw tab shows the content of the output `bibtex` file - the `.bbl` file; the html tab shows the output of `htlatex`, and the pixel tab shows the output of `pdflatex` as a bitmap (converted by convert). Any time the current output tab selection is changed - or when the dropdowns' selections are changed - the output is automatically re-rendered for the current tab; if you change the text in the editor, then use the "Rerender!" button. 

There is only one indication that the software is working on rendering an output - that is the addition of the string "(working)" in the title bar. Note that it takes different time to render the outputs - raw bibtex output is the fastest, followed by Latex pixel output, and the slowest is the html output of `htlatex` - because `htlatex` may actually call `latex` up to three times, before finally generating a result. The html output is there mostly to allow you, the user, the possibility to copy/paste a _plain-text_ citation, however one that is formatted according to the current settings.

The application generates output based on a `.tex` template which is written in the source code - it can be changed there to suit your needs; as a starting point, it uses Latex packages `[utf8]{inputenc}` and `{hyperref}`. The Latex processing then occurs in a temporary directory using temporary files, which should be deleted after each rendering. 

## Implementation notes

The script contains the `glade` interface specification inline, as a string - which is processed each time the application is started, in order to generate the GUI; thus, the application can be shipped as a single `.py` file. 

The application is written in `pygtk` because it was relatively easy for me to write the GUI in `glade`, and to use the `pygtk` API. Unfortunately, `pygtk` is already obsolete: it specifically refers to Python 2.x bindings to Gtk 2. Current versions are Python 3 and Gtk 3 (and the current bindings are for Python 3 to Gtk 3), both incompatible with their respective previous versions. In principle, it should be possible to rewrite the script, in a dialect that will work in both Python 2 and Python 3; however, the binding to Gtk is completely changed, since the underlying version of Gtk is changed. 

As such, it is currently more trouble than its worth for me, to try and have this script updated for modern (as of 2014) versions of Python (3) and Gtk (3); maybe some day I'll be able to come up with a solution, but no guarantees for that (look up older versions of the script in the Sourceforge SVN, for some notes of my failed attempts to address this.). For those that have the means and inclination, though - feel free to fork, if you find this useful `:)`

